%span.section-header Demographic Information

- entity = @event.active_patient.active_primary_entity
- patient = entity.person

%br
#patient_name
  .three-valued-row
    .left
      %span.print-label Last Name:
      %span.print-value
        = "#{patient.last_name}"
    .left
      %span.print-label First Name:
      %span.print-value
        = "#{patient.first_name}"
    .right
      %span.print-label Middle Name:
      %span.print-value
        = "#{patient.middle_name}"

- entities_location = entity.entities_location
- no_location = entities_location.nil?
- address = entities_location.location.current_address unless no_location
- no_address = no_location || address.nil?

#patient_address
  .three-valued-row
    .left
      %span.print-label Address:
      - unless no_address
        %span.print-value
          = "#{address.street_number} #{address.street_name}" + ((not address.unit_number.blank?) ? ", Unit #{address.unit_number}" : "")
    .left
      %span.print-label City:
      - unless no_address
        %span.print-value
          = "#{address.city}"
    .right
      %span.print-label State:
      - unless no_address
        %span.print-value
          = "#{l address.state}"

  .three-valued-row
    .left
      %span.print-label County:
      - unless no_address
        %span.print-value
          = "#{l address.county}"
    .left
      %span.print-label Zip:
      - unless no_address
        %span.print-value
          = "#{address.postal_code}"

#patient_age
  .three-valued-row
    %hr
    %br
    .left
      %span.print-label DOB:
      %span.print-value
        = "#{patient.birth_date}"
    .left
      %span.print-label Age:
      %span.print-value
        = "#{ calculate_age(patient.birth_date)}" unless patient.birth_date.blank?
    .right
      %span.print-label Approximate Age:
      %span.print-value
        = "#{patient.approximate_age_no_birthday}"

- entities_location = entity.telephone_entities_location
- no_location = entities_location.nil?
- phone = entity.primary_phone_entities_location.location.current_phone unless no_location
- no_phone = no_location || phone.nil?

#patient_phone
  .three-valued-row
    %hr
    %br
    .left
      %span.print-label Phone:
      - unless no_phone
        %span.print-value
          = fml "(", phone.area_code, ") "
          = phone_number(phone.phone_number)
          = fml " Ext. ", phone.extension, ""
    -# Revisit when we can collect more than one phone number
    -# this doesn't need to show up right now
    -# .left
    -# %span.print-label Phone #2:
    -# .right
    -# %span.print-label Phone #3:

#patient_attributes
  .three-valued-row
    %hr
    %br
    .left
      %span.print-label Birth Gender:
      %span.print-value
        = "#{l patient.birth_gender}"
    .left
      %span.print-label Primary Language:
      %span.print-value
        = "#{l patient.primary_language}"
    .right
      %span.print-label Ethnicity:
      %span.print-value
        = "#{l patient.ethnicity }"

  .three-valued-row
    .left
      %span.print-label Race:
      %span.print-value
        - i = 0
        - for race in entity.races
          = " and " unless i == 0
          = l race
          - i += 1
