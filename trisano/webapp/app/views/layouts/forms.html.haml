-# Copyright (C) 2007, 2008, The Collaborative Software Foundation
-#
-# This file is part of TriSano.
-#
-# TriSano is free software: you can redistribute it and/or modify it under the terms of the
-# GNU Affero General Public License as published by the Free Software Foundation, either 
-# version 3 of the License, or (at your option) any later version.
-#
-# TriSano is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; 
-# without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  
-# See the GNU Affero General Public License for more details.
-# 
-# You should have received a copy of the GNU Affero General Public License along with TriSano. 
-# If not, see http://www.gnu.org/licenses/agpl-3.0.txt.

!!!
%html
  %head
    %title TriSano

    = stylesheet_link_tag 'grid'
    = stylesheet_link_tag 'structure'
    = stylesheet_link_tag 'formbuilder'
    = stylesheet_link_tag 'typography'
    = stylesheet_link_tag 'scaffold'

    / Sam Skin CSS for TabView
    = stylesheet_link_tag '../yuinew/build/tabview/assets/skins/sam/tabview.css'
    / = stylesheet_link_tag '../yui/build/button/assets/skins/sam/button.css' 

    / Menu Stylesheet (required for creating buttons of type "menu" and "split")
    / = stylesheet_link_tag '../yui/build/menu/assets/skins/sam/menu.css'

    / JavaScript Dependencies for Tabview
    = javascript_include_tag '../yuinew/build/yahoo-dom-event/yahoo-dom-event.js'
    = javascript_include_tag '../yuinew/build/element/element-beta-min.js'

    / Source files
    = javascript_include_tag '../yuinew/build/tabview/tabview-min.js'
    / = javascript_include_tag '../yui/build/button/button-min.js'
    / = javascript_include_tag '../yui/build/tabview/ScrollTabView.js'
    = javascript_include_tag :defaults
    = calendar_date_select_includes

    / JavaScript file for Animation
    / = javascript_include_tag '../yui/build/animation/animation-min.js'

    / OPTIONAL: Menu and Container Core (required for creating buttons of type "menu" and "split")
    / = javascript_include_tag '../yui/build/container/container_core-min.js'
    / = javascript_include_tag '../yui/build/menu/menu-min.js'

    = stylesheet_link_tag 'redbox'
    = javascript_include_tag 'redbox'

    = javascript_include_tag 'autotab'

  %body.yui-skin-sam
    #head
      .container
        .left
          %a{:href => home_path}
            = image_tag("logo.png", :border => 0)
        .right
          .areas
            - if User.current_user.is_entitled_to?(:create_event)
              = link_to 'NEW CMR', new_cmr_path
              |
            = link_to 'CMRS', cmrs_path
            |
            - if User.current_user.is_admin?
              = link_to 'FORMS', forms_path
              |
            = link_to 'SEARCH', search_path
            - if User.current_user.is_admin?
              |
              = link_to 'ADMIN', admin_path
          .user
            - if RAILS_ENV == "production"
              = current_user_name
            - else 
              - users = User.find(:all).collect { |user| [ user.user_name, user.uid] }
              = form_remote_tag(:url => url_for(:controller => "events", :action => "change_user"))
              %span{:id => "user_name"}= current_user_name + ":"
              = select_tag("user_id", options_for_select(users, User.current_user.uid), :onchange => "this.form.onsubmit()")
              </form>
    #bar
      .container
        .left.areas_title
          = yield :title
        .right.action1
          = yield :tools_two
    #form-content
      .container
        = yield
      .container
        #foot
          .footlogo
            = image_tag("foot.png", :border => 0)
          .foottext
            %a{:href => 'https://trisano.csinitiative.net/wiki/ProvideFeedbackOnTriSano'} TriSano Feedback
            | 
            %a{:href => 'http://www.trisano.org'} TriSano.org
